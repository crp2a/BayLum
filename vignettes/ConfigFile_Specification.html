<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Sebastian Kreutzer" />


<title>BayLum: Specification of the YAML config file</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>







<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">BayLum: Specification of the YAML config
file</h1>
<h4 class="author">Sebastian Kreutzer</h4>
<h4 class="date">Updated for BayLum package version &gt;= 0.3.2.9000.14
(2023-08-03)</h4>


<div id="TOC">
<ul>
<li><a href="#background-and-scope" id="toc-background-and-scope"><span class="toc-section-number">1</span> Background and scope</a></li>
<li><a href="#key-concepts" id="toc-key-concepts"><span class="toc-section-number">2</span> Key concepts</a></li>
<li><a href="#examples-and-detailed-specifications" id="toc-examples-and-detailed-specifications"><span class="toc-section-number">3</span> Examples and detailed
specifications</a>
<ul>
<li><a href="#a-single-sample-entry" id="toc-a-single-sample-entry"><span class="toc-section-number">3.1</span> A single sample entry</a></li>
<li><a href="#multiple-records" id="toc-multiple-records"><span class="toc-section-number">3.2</span> Multiple records</a></li>
<li><a href="#paramter-specifcation" id="toc-paramter-specifcation"><span class="toc-section-number">3.3</span> Paramter specifcation</a>
<ul>
<li><a href="#top-level-sample-files" id="toc-top-level-sample-files"><span class="toc-section-number">3.3.1</span> Top level (<code>sample</code>,
<code>files</code>)</a>
<ul>
<li><a href="#sample" id="toc-sample"><span class="toc-section-number">3.3.1.1</span> <code>sample</code></a></li>
<li><a href="#files" id="toc-files"><span class="toc-section-number">3.3.1.2</span> <code>files</code></a></li>
</ul></li>
<li><a href="#settings-level" id="toc-settings-level"><span class="toc-section-number">3.3.2</span> <code>settings</code>
level</a></li>
<li><a href="#rules-level" id="toc-rules-level"><span class="toc-section-number">3.3.3</span> <code>rules</code>
level</a></li>
</ul></li>
<li><a href="#final-remarks" id="toc-final-remarks"><span class="toc-section-number">3.4</span> Final remarks</a></li>
</ul></li>
</ul>
</div>

<div id="background-and-scope" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Background and
scope</h1>
<p>In earlier versions of <code>&#39;BayLum&#39;</code> measurement data and
settings had to be prepared using a multiple folder structure comprising
various CVS and BIN/BINX files in a very particular way. This concept
proved error-prone and left a lot of frustrated <code>&#39;BayLum&#39;</code>
users behind, who sometimes spent hours trying to understand unclear
error messages and then realising that there was a typo in one of the
CSV files, or the folder structure was not precisely how
<code>&#39;BayLum&#39;</code> expected it to be found. By switching to a
single-configuration file users have more options while the settings are
cleaner and less scatters over different files in numerous subfolders.
The parameter naming follows the naming convention used in the “old”
<code>&#39;BayLum&#39;</code> CSV-files.</p>
<p>The purpose of this document is the specification and description of
the <a href="https://en.wikipedia.org/wiki/YAML">YAML</a> (file ending
<code>*.yml</code>) configuration file used by the function
<code>create_DataFile()</code> to provide data input and settings to the
<code>&#39;BayLum&#39;</code> modelling. The YAML file is an alternative and a
future replacement of the previous folder structure with various CSV
files required by the functions <code>Generate_DataFile()</code> and
<code>Generate_DateFile_MG()</code>.</p>
</div>
<div id="key-concepts" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Key concepts</h1>
<p>The configuration file uses the <a href="https://en.wikipedia.org/wiki/YAML">YAML</a> format, which uses
indention to nest different parameters. Please see the cited
documentation for details, for <code>&#39;BayLum&#39;</code> the following
features stick out:</p>
<ul>
<li>Only a single configuration file is needed</li>
<li>The path of the file on your hard drive does not matter</li>
<li>Measurement data can be stored wherever you like to have them,
although it makes sense to pool them into one folder for the
analysis</li>
<li>One sample is one record in the YAML file. If data of one sample is
scattered over different measurement files (e.g., BIN/BINX), one sample
still has only one record.</li>
</ul>
</div>
<div id="examples-and-detailed-specifications" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Examples and detailed
specifications</h1>
<div id="a-single-sample-entry" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> A single sample
entry</h2>
<p>A single sample entry appears as follows:</p>
<pre><code>- sample: &quot;samp1&quot;
  files: 
    - &quot;/yourhardrive/yourfolder/sample_one.binx&quot;
  settings:
    dose_source: { value: 0.1535, error: 0.00005891 }
    dose_env: { value: 2.512, error: 0.05626 }
    rules:
        beginSignal: 6
        endSignal: 8
        beginBackground: 50
        endBackground: 55
        beginTest: 6
        endTest: 8
        beginTestBackground: 50
        endTestBackground: 55
        inflatePercent: 0.027
        nbOfLastCycleToRemove: 1
</code></pre>
<p>Each new record (aka sample) starts with a <code>-</code> and the
indention as shown above. Furthermore:</p>
<ul>
<li>Indention rules need to be followed strictly</li>
<li>Each record has three levels: top level, settings level, rules level
and this nesting needs to be kept</li>
<li>Only parameters shown in the examples are allowed, and the list of
parameters need to be complete (i.e. you cannot just remove a
parameter)</li>
<li>Sample names need to be <strong>unique</strong></li>
</ul>
<p>Other than that, if you keep these simple rules in mind, you will
have an easy time preparing your <code>&#39;BayLum&#39;</code> analysis.</p>
</div>
<div id="multiple-records" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Multiple records</h2>
<p>While the single record makes an easy case, you probably have more
than one sample to be thrown into the modelling. Although the number of
records is not limited, we keep it simple here; a two records entry
(dots replace the entries as shown above):</p>
<pre><code># this is a coment for sample number one
- sample: &quot;samp1&quot;
  files: 
    - &quot;/yourhardrive/yourfolder/sample_one.binx&quot;
  settings:
    dose_source: { value: 0.1535, error: 0.00005891 }
    dose_env: { value: 2.512, error: 0.05626 }
    rules:
        beginSignal: 6
        .
        .
        .
        nbOfLastCycleToRemove: 1
# this is a coment for sample number two
- sample: &quot;samp2&quot;
  files: null
  settings:
    dose_source: { value: 0.1535, error: 0.00005891 }
    dose_env: { value: 2.512, error: 0.05626 }
    rules:
        beginSignal: 6
        .
        .
        .
        nbOfLastCycleToRemove: 1</code></pre>
<p>As you can see from the example, you can also add comments to the
records, which start with <code>#</code>. The two records also show
different entries for argument <code>files</code>. In the first case, a
file path is given, while for record number two, <code>files</code> is
set to <code>null</code>. Both options are possible. In the first case,
the record specifies where the measurement data can be found. In the
second case it is assumed that an R object with the name
<code>samp2</code> can be found in the global environment of your R
session.</p>
</div>
<div id="paramter-specifcation" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Paramter
specifcation</h2>
<div id="top-level-sample-files" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Top level
(<code>sample</code>, <code>files</code>)</h3>
<p>The top level has two parameters:</p>
<div id="sample" class="section level4" number="3.3.1.1">
<h4><span class="header-section-number">3.3.1.1</span>
<code>sample</code></h4>
<p>This parameter specifies the name of the sample. This <strong>name
must be unique</strong> and is ideally free of non-ASCII characters and
white space.</p>
</div>
<div id="files" class="section level4" number="3.3.1.2">
<h4><span class="header-section-number">3.3.1.2</span>
<code>files</code></h4>
<p>This parameter can be <code>null</code> (<code>files</code> is the
only parameter that can be set to <code>null</code>) or is followed by a
set of <code>-</code> with the path to the measurement file given in
quotes. The number of entries under <code>files</code> is not limited.
Example:</p>
<pre><code>  files: 
    - &quot;/yourhardrive/yourfolder/sample_one_a.binx&quot;
    - &quot;/yourhardrive/yourfolder/sample_one_b.binx&quot;</code></pre>
<p>If the entry is <code>null</code>, the function
<code>BayLum::create_DataFile()</code> that uses the settings from the
YAML file will assume that R objects with the name specified in
<code>sample</code> are available in the global session environment. For
instance, files are imported and<br />
treated with
<code>Luminescence::read_BIN2R(...) |&gt; subset(...)</code> or similar.
Setting <code>files</code> to <code>null</code> gives you all options to
pre-process your measurement data and is the recommended mode of
operation.</p>
<p>If <code>files</code> comes with file path entries, then
<code>BayLum::create_DataFile()</code> will try to import those files
using the appropriate import functions. This is very convenient,
however, except for minimal filtering (e.g., removing non-OSL and
non-IRSL curves), the measurement data remain untreated, and
<code>BayLum::create_DataFile()</code> expects that all data are
complete (e.g., identical number of curves), without error and strictly
follow the SAR structure.</p>
</div>
</div>
<div id="settings-level" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span>
<code>settings</code> level</h3>
<p>The <code>settings</code> level allows you to specify the dose rate
of your source used for the irradiation in Gy/s
(<code>dose_source</code>) and the environmental dose rate in Gy/ka
(<code>dose_env</code>). Each value needs to be provided with its
uncertainty, as shown in the example:</p>
<pre><code>  settings:
    dose_source: { value: 0.1535, error: 0.00005891 }
    dose_env: { value: 2.512, error: 0.05626 }</code></pre>
</div>
<div id="rules-level" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> <code>rules</code>
level</h3>
<p>The rules level enables you to provide a couple of parameters, which
are used in Bayesian modelling.</p>
<table>
<colgroup>
<col width="23%" />
<col width="16%" />
<col width="60%" />
</colgroup>
<thead>
<tr class="header">
<th>PARAMETER</th>
<th>TYPE</th>
<th>COMMENT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>beginSignal</code></td>
<td>integer</td>
<td>Channel number start OSL signal integral (<span class="math inline">\(L_x\)</span>)</td>
</tr>
<tr class="even">
<td><code>endSignal</code></td>
<td>integer</td>
<td>Channel number end OSL signal integral (<span class="math inline">\(L_x\)</span>)</td>
</tr>
<tr class="odd">
<td><code>beginBackground</code></td>
<td>integer</td>
<td>Channel number start OSL background integral (<span class="math inline">\(L_x\)</span>)</td>
</tr>
<tr class="even">
<td><code>endBackground</code></td>
<td>integer</td>
<td>Channel number end OSL background integral (<span class="math inline">\(L_x\)</span>)</td>
</tr>
<tr class="odd">
<td><code>beginTest</code></td>
<td>integer</td>
<td>Channel number start OSL signal integral (<span class="math inline">\(T_x\)</span>)</td>
</tr>
<tr class="even">
<td><code>endTest</code></td>
<td>integer</td>
<td>Channel number end OSL signal integral (<span class="math inline">\(T_x\)</span>)</td>
</tr>
<tr class="odd">
<td><code>beginTestBackground</code></td>
<td>integer</td>
<td>Channel number start OSL background integral (<span class="math inline">\(T_x\)</span>)</td>
</tr>
<tr class="even">
<td><code>endTestBackground</code></td>
<td>integer</td>
<td>Channel number end OSL background integral (<span class="math inline">\(T_x\)</span>)</td>
</tr>
<tr class="odd">
<td><code>inflatePercent</code></td>
<td>double</td>
<td>Additional overdispersion value to inflate the uncertainty in
percentage</td>
</tr>
<tr class="even">
<td><code>nbOfLastCycleToRemove</code></td>
<td>integer</td>
<td>Number of SAR cycles to be removed from the measurement file</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<pre><code>   rules:
        beginSignal: 6
        endSignal: 8
        beginBackground: 50
        endBackground: 55
        beginTest: 6
        endTest: 8
        beginTestBackground: 50
        endTestBackground: 55
        inflatePercent: 0.027
        nbOfLastCycleToRemove: 1</code></pre>
<p>Please ensure that the set values correspond to your measurement
data. For instance, if your OSL curve has only 100 channels (data
points), it does not make sense to set larger integral settings (e.g.,
1000), and such a setting will lead to an error. Integral values for
(<span class="math inline">\(L_x\)</span>) and (<span class="math inline">\(T_x\)</span>) are usually set to identical values
unless you have good reasons to use different integral settings.</p>
</div>
</div>
<div id="final-remarks" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Final remarks</h2>
<p>The YAML settings file is loaded and processed by the function
<code>BayLum::create_DataFile()</code> using
<code>yaml::read_yaml()</code> from the R package <code>&#39;yaml&#39;</code>.
<code>yaml::read_yaml()</code> returns a <code>list</code> on R, which
is then processed by <code>BayLum::create_DataFile()</code>. Sometimes
it makes sense to modify the settings on the fly in R. To avoid import
and export of YAML files, <code>BayLum::create_DataFile()</code> always
tries to process the input of the parameter
<code>BayLum::create_DataFile(config_file, ...)</code> as a
<code>list</code> before trying to load a YAML file from the hard drive.
While this option is usually unnecessary, this information may help in
more complex R scripts.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
