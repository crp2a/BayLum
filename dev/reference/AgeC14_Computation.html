<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian analysis for C-14 age estimations of various samples — AgeC14_Computation • BayLum</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian analysis for C-14 age estimations of various samples — AgeC14_Computation"><meta name="description" content="This function calibrates the C-14 age of samples to get an age (in ka).
The user can choose one of the following radiocarbon calibration curve:
Northern or Southern Hemisphere or marine atmospheric. It must be the same curve for all samples."><meta property="og:description" content="This function calibrates the C-14 age of samples to get an age (in ka).
The user can choose one of the following radiocarbon calibration curve:
Northern or Southern Hemisphere or marine atmospheric. It must be the same curve for all samples."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayLum</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.3.3.9000-13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/BayLum.html"><span class="play"></span> Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/ConfigFile_Specification.html"><span class="play"></span> YAML configuration</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Lum/BayLum"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian analysis for C-14 age estimations of various samples</h1>
      <small class="dont-index">Source: <a href="https://github.com/crp2a/BayLum/blob/master/R/AgeC14_Computation.R" class="external-link"><code>R/AgeC14_Computation.R</code></a></small>
      <div class="d-none name"><code>AgeC14_Computation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calibrates the C-14 age of samples to get an age (in ka).
The user can choose one of the following radiocarbon calibration curve:
Northern or Southern Hemisphere or marine atmospheric. It must be the same curve for all samples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AgeC14_Computation</span><span class="op">(</span></span>
<span>  <span class="va">Data_C14Cal</span>,</span>
<span>  <span class="va">Data_SigmaC14Cal</span>,</span>
<span>  <span class="va">SampleNames</span>,</span>
<span>  <span class="va">Nb_sample</span>,</span>
<span>  PriorAge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span><span class="op">)</span>, <span class="va">Nb_sample</span><span class="op">)</span>,</span>
<span>  SavePdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  OutputFileName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MCMCplot"</span>, <span class="st">"HPD_CalC-14Curve"</span>, <span class="st">"summary"</span><span class="op">)</span>,</span>
<span>  OutputFilePath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>,</span>
<span>  SaveEstimates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  OutputTableName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DATA"</span><span class="op">)</span>,</span>
<span>  OutputTablePath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>,</span>
<span>  StratiConstraints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  sepSC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">","</span><span class="op">)</span>,</span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span><span class="op">)</span>,</span>
<span>  CalibrationCurve <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IntCal20"</span><span class="op">)</span>,</span>
<span>  Iter <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  t <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  n.chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  roundingOfValue <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-c-cal">Data_C14Cal<a class="anchor" aria-label="anchor" href="#arg-data-c-cal"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): corresponding to C-14 age estimate.</p></dd>


<dt id="arg-data-sigmac-cal">Data_SigmaC14Cal<a class="anchor" aria-label="anchor" href="#arg-data-sigmac-cal"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (<strong>required</strong>): corresponding to the error of C-14 age estimates.</p></dd>


<dt id="arg-samplenames">SampleNames<a class="anchor" aria-label="anchor" href="#arg-samplenames"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (<strong>required</strong>): names of sample. The length of this vector is equal to <code>Nb_sample</code>.</p></dd>


<dt id="arg-nb-sample">Nb_sample<a class="anchor" aria-label="anchor" href="#arg-nb-sample"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a>: number of samples.</p></dd>


<dt id="arg-priorage">PriorAge<a class="anchor" aria-label="anchor" href="#arg-priorage"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> (with default): lower and upper bounds for age parameter of each sample in years (not in ka).
Note that, <code>length(PriorAge) == 2 * Nb_sample</code>
and <code>PriorAge[2i-1,2i]</code> corresponds to the lower and upper bounds of sample whose number ID is equal to <code>i</code>.</p></dd>


<dt id="arg-savepdf">SavePdf<a class="anchor" aria-label="anchor" href="#arg-savepdf"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (with default): if TRUE save graphs in pdf file named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p></dd>


<dt id="arg-outputfilename">OutputFileName<a class="anchor" aria-label="anchor" href="#arg-outputfilename"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (with default): name of the pdf file that will be generated by the function if <code>SavePd=TRUE</code>,
<code>length(OutputFileName) = =3</code>, see <b>PLOT OUTPUT</b> in <b>Value</b> section for more informations.</p></dd>


<dt id="arg-outputfilepath">OutputFilePath<a class="anchor" aria-label="anchor" href="#arg-outputfilepath"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (with default): path to the pdf file that will be generated by the function if <code>SavePdf=TRUE</code>.
If it is not equal to "", it must be terminated by "/".</p></dd>


<dt id="arg-saveestimates">SaveEstimates<a class="anchor" aria-label="anchor" href="#arg-saveestimates"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (with default): if TRUE save Bayes' estimates, credible interval at level 68% and 95% and
the result of the Gelman and Rubin test of convergence, in a csv table named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p></dd>


<dt id="arg-outputtablename">OutputTableName<a class="anchor" aria-label="anchor" href="#arg-outputtablename"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (with default): name of the table that will be generated by the function if <code>SaveEstimates=TRUE</code>.</p></dd>


<dt id="arg-outputtablepath">OutputTablePath<a class="anchor" aria-label="anchor" href="#arg-outputtablepath"></a></dt>
<dd><p>character (with default): path to the table that will be generated by the function if <code>SaveEstimates=TRUE</code>.
If it is not equal to "", it must be terminated by "/".</p></dd>


<dt id="arg-straticonstraints">StratiConstraints<a class="anchor" aria-label="anchor" href="#arg-straticonstraints"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a> matrix or character(with default): input object for the stratigraphic relation between samples.
If there is stratigraphic relation between samples see the details section for instructions regarding how to correctly fill <code>StratiConstraints</code>;
the user can refer to a matrix (numeric matrix) or to a csv file (character).
If there is no stratigraphic relation default value is suitable.</p></dd>


<dt id="arg-sepsc">sepSC<a class="anchor" aria-label="anchor" href="#arg-sepsc"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (with default): if <code>StratiConstraints</code> is character,
indicate column separator in <code>StratiConstraints</code> csv file.</p></dd>


<dt id="arg-model">Model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (with default): if <b>"full"</b>, error on estimate calibration curve is taken account.
If <b>"naive"</b> this error is not taken account in the age estimate.</p></dd>


<dt id="arg-calibrationcurve">CalibrationCurve<a class="anchor" aria-label="anchor" href="#arg-calibrationcurve"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a> (with default): calibration curve chosen. Allowed inputs are</p><ul><li><p><b>"Intcal13"</b> or <b>"Intcal13"</b> for Northern Hemisphere atmospheric radiocarbon calibration curve,</p></li>
<li><p><b>"Marine13"</b> or <b>"Marine13"</b> for Marine radiocarbon calibration curve,</p></li>
<li><p><b>"SHCal13"</b> or <b>"SHCal20"</b> for Southern Hemisphere atmospheric radiocarbon calibration curve</p></li>
<li><p><b>a csv file, with tree columns, the first column is dedicated to <code>"Cal.BP"</code>, the second to <code>"XC-14.age"</code>, the third to <code>"Error"</code>.
The decimal of this file must be a dot, and the separator must be a comma. </b></p></li>
</ul></dd>


<dt id="arg-iter">Iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (with default): number of iterations for the MCMC computation (for more information see <a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">rjags::jags.model</a>).</p></dd>


<dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>integer (with default): 1 every <code>t</code> iterations of the MCMC is considered for sampling the posterior distribution
(for more information see <a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">rjags::jags.model</a>.</p></dd>


<dt id="arg-n-chains">n.chains<a class="anchor" aria-label="anchor" href="#arg-n-chains"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (with default): number of independent chains for the model (for more information see <a href="https://rdrr.io/pkg/rjags/man/jags.model.html" class="external-link">rjags::jags.model</a>.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a> (with default): enables/disables <a href="https://rdrr.io/pkg/rjags/man/rjags-package.html" class="external-link">rjags::rjags-package</a> messages</p></dd>


<dt id="arg-roundingofvalue">roundingOfValue<a class="anchor" aria-label="anchor" href="#arg-roundingofvalue"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> (with default):  Integer indicating the number of decimal places to be used, default set to 3.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><b>NUMERICAL OUTPUT</b></p>
<ol><li><p><b>A list containing the following objects:</b></p><ul><li><p><b>Sampling</b>: that corresponds to a sample of the posterior distributions of the age parameters;</p></li>
<li><p><b>Outlier</b>: stating the names of samples that are considered as outliers;</p></li>
<li><p><b>Model</b>: stating which model was chosen (<code>"full"</code> or <code>"naive"</code>);</p></li>
<li><p><b>CalibrationCurve</b>: stating which radiocarbon calibration curve was chosen;</p></li>
<li><p><b>PriorAge</b>: stating the priors used for the age parameter;</p></li>
<li><p><b>StratiConstraints</b>: stating the stratigraphic relations between samples considered in the model.</p></li>
</ul></li>
<li><p><b>The Gelman and Rubin test of convergency</b>: print the result of the Gelman and Rubin test of convergence for the age estimate for each sample.
A result close to one is expected.<br>
In addition, the user must visually assess the convergence of the trajectories by looking at the graph
generated by the function (see <b>PLOT OUTPUT</b> for more informations).<br>
If both convergences (Gelman and Rubin test and plot checking) are satisfactory,
the user can consider the estimates as valid.
Otherwise, the user may try increasing the number of MCMC iterations (<code>Iter</code>)
or being more precise if it is possible on the <code>PriorAge</code> parameter to reach convergence.</p></li>
<li><p><b>Credible intervals and Bayes estimates</b>: prints the Bayes' estimates, the credible intervals at 95% and 68% for
the age parameters for each sample.</p></li>
</ol><p><b>PLOT OUTPUT</b></p>
<ol><li><p><b>MCMC trajectories</b>: A graph with the MCMC trajectories and posterior distributions of the age parameter is displayed. <br>
On each line, the plot on the left represents the MCMC trajectories, and the one on the right the posterior distribution of the parameter.</p></li>
<li><p><b>Summary of sample age estimates</b>: plot credible intervals and Bayes' estimate of each sample age on one graph.</p></li>
</ol><p>To give the results in a publication, we recommend to give the Bayes' estimate of the parameters as well as the credible interval at 95% or 68%.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>How to fill <code>StratiConstraints</code>?</strong></p>
<p>If there is stratigraphic relations between samples, <em>C-14 age in <code>Data_C14Cal</code> must be ordered by order of increasing ages</em>.</p>
<p>The user can fill the <code>StratiConstraints</code> matrix as follow.</p><ol><li><p><strong>Size of the matrix</strong>: row number of <code>StratiConstraints</code> matrix is equal to <code>Nb_sample+1</code>,
and column number is equal to <code>Nb_sample</code>.</p></li>
<li><p><strong>First line of the matrix</strong>:
for all <code>i in {1,...,Nb_Sample}</code>, <code>StratiConstraints[1,i]=1</code> that means the lower bound
of the sample age (given in <code>PriorAge[2i-1]</code>)
for the sample whose number ID is equal to <code>i</code>, is taken into account.</p></li>
<li><p><strong>Sample relations</strong>: for all  <code>j in {2,...,Nb_Sample+1}</code> and all <code>i in {j,...,Nb_Sample}</code>,
<code>StratiConstraints[j,i]=1</code> if sample age whose number ID is equal to <code>j-1</code> is lower than
sample age whose number ID is equal to <code>i</code>. Otherwise, <code>StratiConstraints[j,i]=0</code>.</p></li>
</ol><p>Note that <code>StratiConstraints_{2:Nb_sample+1,1:Nb_sample}</code> is a upper triangular matrix.</p>
<p>The user can also use <code>SCMatrix</code> or <a href="SC_Ordered.html">SC_Ordered</a> (if all samples are ordered) functions
to construct the <code>StratiConstraints</code> matrix.</p>
<p>The user can also refer to a .csv file that contains the relation between samples as defined above.
The user must take care about the separator used in the csv file using the argument <code>sepSC</code>.<br></p>
<p>** More precision on <code>Model</code> **<br></p>
<p>We propose two models "full" or "naive". If <code>Model = 'full'</code> that means
measurement error and error on calibration curve are taken account in
the Bayesian model; if <code>Model = "naive"</code> that means only error on measurement
are taken account in the mode.</p>
<p>More precisely, the model considered here, as the one developed by Christen, JA (1994),
assume multiplicative effect of errors to address the problem of outliers.
In addition, to not penalise variables that are not outliers and damage theirs estimation,
we introduce a structure of mixture, that means only variable that are considered
as outlier have in addition a multiplicative error.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Please note that the initial values for all MCMC are currently all the same for all chains since we rely on the automatic
initial value generation of JAGS. This is not optimal and will be changed in future. However, it does not affect the quality
of the age estimates if the chains have converged.</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-cite">How to cite<a class="anchor" aria-label="anchor" href="#how-to-cite"></a></h2>
    <p>Christophe, C., Philippe, A., Guérin, G., Kreutzer, S., 2024. AgeC14_Computation(): Bayesian analysis for C-14 age estimations of various samples. In: Christophe, C., Philippe, A., Kreutzer, S., Guérin, G., Baumgarten, F.H., Frerebeau, N., 2024. BayLum: Chronological Bayesian Models Integrating Optically Stimulated. R package version 0.3.3.9000-13. https://CRAN.r-project.org/package=BayLum</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Christen, JA (1994). Summarizing a set of radiocarbon determinations: a robust approach. Applied Statistics, 489-503.</p>
<p>Reimer PJ, Bard E, Bayliss A, Beck JW, Blackwell PC, Bronl Ramsey C, Buck CE, Cheng H, Edwards RL, Friedrich M,
Grootes PM, Guilderson TP, Haflidason H, Hajdas I, Hatte C, Heaton TJ, Hoffmann DL, Hogg AG, Hughen KA, Kaiser KF, Kromer B,
Manning SW, Niu M, Reimer RW, Richards DA, Scott EM, Southon JR, Staff RA, Turney CSM, van der Plicht J. 2013.
IntCal13 ans Marine13 radiocarbon age calibration curves 0-50000 years cal BP. Radiocarbon 55(4)=1869-1887.</p>
<p>Hogg AG, Hua Q, Blackwell PG, Niu M, Buck CE, Guilderson TP, Heaton TJ, Palmer JG, Reimer PJ, Reimer RW, Turney CSM, Zimmerman SRH.
2013. SHCal13 Southern Hemisphere calibration, 0-50000 years cal. BP Radiocarbon 55(4):1889-1903</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://rdrr.io/pkg/rjags/man/rjags-package.html" class="external-link">rjags::rjags-package</a>, <a href="plot_MCMC.html">plot_MCMC</a>, <a href="SCMatrix.html">SCMatrix</a>, <a href="plot_Ages.html">plot_Ages</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Claire Christophe, Anne Philippe, Guillaume Guérin, Sebastian Kreutzer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DATA_C14</span>,envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">C14Cal</span> <span class="op">&lt;-</span> <span class="va">DATA_C14</span><span class="op">$</span><span class="va">C14</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">SigmaC14Cal</span> <span class="op">&lt;-</span> <span class="va">DATA_C14</span><span class="op">$</span><span class="va">C14</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Names</span> <span class="op">&lt;-</span> <span class="va">DATA_C14</span><span class="op">$</span><span class="va">Names</span></span></span>
<span class="r-in"><span><span class="va">nb_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Names</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Age computation of samples without stratigraphic relations</span></span></span>
<span class="r-in"><span><span class="va">Age</span> <span class="op">&lt;-</span> <span class="fu">AgeC14_Computation</span><span class="op">(</span></span></span>
<span class="r-in"><span> Data_C14Cal <span class="op">=</span> <span class="va">C14Cal</span>,</span></span>
<span class="r-in"><span> Data_SigmaC14Cal <span class="op">=</span> <span class="va">SigmaC14Cal</span>,</span></span>
<span class="r-in"><span> SampleNames <span class="op">=</span> <span class="va">Names</span>,</span></span>
<span class="r-in"><span> Nb_sample <span class="op">=</span> <span class="va">nb_sample</span>,</span></span>
<span class="r-in"><span> PriorAge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">60</span><span class="op">)</span>,<span class="va">nb_sample</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> Iter <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span> quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span> roundingOfValue <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[plot_MCMC()] 'n.iter' out of range, reset to number of observations</span>
<span class="r-plt img"><img src="AgeC14_Computation-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="AgeC14_Computation-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="AgeC14_Computation-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="AgeC14_Computation-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;&gt; MCMC Convergence of Age parameters &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample name   Bayes estimate   Uppers credible interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A_S-EVA-26510 	 1.192 		 1.301 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A_S-EVA-26506 	 1.007 		 1.014 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A_S-EVA-26507 	 1.075 		 1.148 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A_S-EVA-26508 	 1.002 		 1.013 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  *** WARNING: The following information are only valid if the MCMC chains have converged  ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt;&gt; Bayes estimates of Age for each sample and credible interval &lt;&lt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample name 	 Bayes estimate  Credible interval: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A_S-EVA-26510 	 41.8844424209351 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 						 lower bound 	 upper bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 				 at level 95% 	 41.43 		 42.388 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 				 at level 68% 	 41.805 		 42.24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample name 	 Bayes estimate  Credible interval: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A_S-EVA-26506 	 45.7259208992242 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 						 lower bound 	 upper bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 				 at level 95% 	 45.173 		 46.511 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 				 at level 68% 	 45.476 		 45.973 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample name 	 Bayes estimate  Credible interval: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A_S-EVA-26507 	 44.9408930781989 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 						 lower bound 	 upper bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 				 at level 95% 	 43.934 		 45.951 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 				 at level 68% 	 44.484 		 45.325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample name 	 Bayes estimate  Credible interval: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A_S-EVA-26508 	 45.0339693179971 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 						 lower bound 	 upper bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 				 at level 95% 	 43.875 		 46.101 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 				 at level 68% 	 44.578 		 45.508 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------</span>
<span class="r-plt img"><img src="AgeC14_Computation-5.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="AgeC14_Computation-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Claire Christophe, Anne Philippe, Sebastian Kreutzer, Guillaume Guérin, Frederik Harly Baumgarten, Nicolas Frerebeau, <a href="https://www.u-bordeaux-montaigne.fr" class="external-link"><img src="https://crp2a.github.io/BayLum/reference/figures/logo_ubm.jpg"></a>, <a href="https://www.cnrs.fr" class="external-link"><img src="https://crp2a.github.io/BayLum/reference/figures/logo_cnrs.jpg"></a>, <a href="https://lascarbx.labex.u-bordeaux.fr" class="external-link"><img src="https://crp2a.github.io/BayLum/reference/figures/logo_idex.png"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

